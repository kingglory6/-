<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <title>购物车</title>
  <meta name="description" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.ico" />

  <!-- all css here -->
  <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/magnific-popup.css" />
  <link rel="stylesheet" href="assets/css/owl.carousel.min.css" />
  <link rel="stylesheet" href="assets/css/font-awesome.min.css" />
  <link rel="stylesheet" href="assets/css/pe-icon-7-stroke.css" />
  <link rel="stylesheet" href="lib/css/nivo-slider.css" type="text/css" />
  <link rel="stylesheet" href="lib/css/preview.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="assets/css/animate.css" />
  <link rel="stylesheet" href="assets/css/meanmenu.min.css" />
  <link rel="stylesheet" href="assets/css/bundle.css" />
  <link rel="stylesheet" href="assets/css/style.css" />
  <link rel="stylesheet" href="assets/css/responsive.css" />
  <link rel="stylesheet" type="text/css" href="assets/css/demo.css" />
  <link rel="stylesheet" type="text/css" href="assets/css/sj-nav.css" />
  <script src="assets/js/vendor/modernizr-2.8.3.min.js"></script>
  <script src="https://unpkg.com/vue/dist/vue.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<body>
  <div class="canvas-wrapper" id="cart">
    <!-- 个人中心 -->
    <div class="menu-wrap">
      <nav class="menu">
        <div class="icon-list">
          <h5>货币:</h5>
          <div class="btn-group">
            <button type="button" class="btn btn-default">人民币</button>
            <button type="button" class="btn btn-default">美元</button>
          </div>
          <h5 class="mt-2">我的账户:{{customer.name}}</h5>
          <a href=""><i class="pe-7s-next-2"></i><span>我的信息</span></a>
          <a href="cart.html"><i class="pe-7s-cart"></i><span>我的购物车</span></a>
          <a href="order.html"><i class="pe-7s-like"></i><span>我的订单</span></a>
          <a href="footprint.html"><i class="pe-7s-like"></i><span>我的收藏</span></a>
          <a href="checkout.html"><i class="pe-7s-check"></i><span>结算</span></a>
          <a href=""><i class="pe-7s-check"></i><span>我的收货地址</span></a>
          <a href=""><i class="pe-7s-add-user"></i><span>退出</span></a>
        </div>
      </nav>
      <button class="close-button" id="close-button">关闭菜单</button>
      <div class="morph-shape" id="morph-shape" data-morph-open="M-1,0h101c0,0,0-1,0,395c0,404,0,405,0,405H-1V0z">
        <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 100 800"
          preserveAspectRatio="none">
          <path d="M-1,0h101c0,0-97.833,153.603-97.833,396.167C2.167,627.579,100,800,100,800H-1V0z" />
        </svg>
      </div>
    </div>

    <div class="content-wrap">
      <div class="content">
        <!-- 导航 -->
        <header class="header-area home-style-2">
          <div class="header-bottom">
            <div class="container">
              <div class="row">
                <div class="col-md-4 col-sm-3 col-xs-6">
                  <div class="logo">
                    <a href="index.html">
                      <img src="assets/img/logo/logo-black.png" alt="">
                    </a>
                  </div>
                </div>
                <div class="col-md-8 col-sm-9 col-xs-6">
                  <div class="cart-menu">
                    <div class="user user-style-3 f-right">
                      <a href="#" id="open-button">
                        <i class="pe-7s-menu"></i>
                      </a>
                    </div>
                    <div class="search-style-2 f-right">
                      <a class="icon-search-2" href="#">
                        <i class="pe-7s-search"></i>
                      </a>
                      <div class="search2-content">
                        <form action="#">
                          <div class="search-input-button2">
                            <input class="" placeholder="Search" type="search">
                            <button class="search-button2" type="submit">
                              <i class="pe-7s-search"></i>
                            </button>
                          </div>
                        </form>
                      </div>
                    </div>
                    <div class="shopping-cart f-right">
                      <a class="top-cart" href="cart.html"><i class="pe-7s-cart"></i></a>
                      <span>01</span>
                      <ul>
                        <li>
                          <div class="cart-img-price">
                            <div class="cart-img">
                              <a href="#"><img src="assets/img/cart/1.jpg" alt="" /></a>
                            </div>
                            <div class="cart-content">
                              <h3><a href="#">头戴式耳机</a> </h3>
                              <span class="cart-price">1 x $ 299.00</span>
                            </div>
                            <div class="cart-del">
                              <i class="pe-7s-close-circle"></i>
                            </div>
                          </div>
                        </li>
                        <li>
                          <p class="total">
                            小计:
                            <span>$299.00</span>
                          </p>
                        </li>
                        <li>
                          <p class="buttons">
                            <a class="my-cart" href="cart.html">查看购物车</a>
                            <a class="checkout" href="checkout.html">结账</a>
                          </p>
                        </li>
                      </ul>
                    </div>
                    <div class="main-menu f-right">
                      <nav>
                        <ul>
                          <li><a href="index.html">主页</a>

                          </li>

                          <li class="mega-position"><a href="shop-page.html">全部 </a>
                            <div class="mega-menu mega-3-colm">
                              <ul>
                                <li v-for="item in categoryList"><a href="shop-page.html">{{item}}</a></li>
                              </ul>
                            </div>
                          </li>

                          <li><a href="footprint.html">足迹</a>
                          </li>
                          <li><a href="footprint.html">收藏</a>

                          </li>
                          <li><a href="login.html">登录</a></li>
                        </ul>
                      </nav>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </header>



        <!-- breadcrumbs start -->
        <div class="breadcrumbs-area breadcrumb-bg ptb-100">
          <div class="container">
            <div class="breadcrumbs text-center">
              <h2 class="breadcrumb-title">购物车</h2>
              <ul>
                <li>
                  <a class="active" href="index.html">主页</a>
                </li>
                <li>购物车</li>
              </ul>
            </div>
          </div>
        </div>
        <!-- breadcrumbs area end -->

        <!-- 购物车项展示 start -->
        <div class="cart-area ptb-100">
          <div class="container">
            <!-- 购物车项展示 -->
            <div class="row">
              <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <form action="#">
                  <div class="table-content table-responsive">
                    <table>
                      <thead>
                        <tr>
                          <th class="product-price">图片</th>
                          <th class="product-name">商品</th>
                          <th class="product-price">价格</th>
                          <th class="product-quantity">数量</th>
                          <th class="product-subtotal">小计</th>
                          <th class="product-name">移除</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr v-for="(p,index) in cart">
                          <td class="product-thumbnail">
                            <a :href="`#${p.spec.param}`"><img v-bind:src='p.spec.img' :alt="`#${p.spec.param}`" /></a>
                          </td>
                          <td class="product-name">
                            <a href="#">{{p.commodity.title}}</a>
                          </td>
                          <td class="product-price">
                            <span class="amount">${{p.commodity.price}}</span>
                          </td>
                          <td class="product-quantity">
                            <input v-model="p.quantity" @click="change" type="number" />
                          </td>
                          <td class="product-subtotal">${{p.commodity.price*p.quantity}}</td>
                          <td class="product-remove">
                            <i class="fa fa-times" @click="del(index)"></i>
                          </td>
                        </tr>
                      </tbody>
                    </table>


                  </div>
                </form>
              </div>
            </div>

            
            <!-- <nav aria-label="Page navigation">
              <ul class="pagination">
                <li :class="(pagenum===1)?classPageC:classPageB">
                   disabled 不允许点击
                  <a class="page-link" @click="changePage(-1)" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                    <span class="sr-only">Previous</span>
                  </a>
                </li>
                <li v-for="(n, index) in pages" :key="index" :class="(pagenum===index+1)?classPageA:classPageB"><a
                    class="page-link" @click="selectPage(index)">{{index+1}}</a></li>
                <li :class="(pagenum===pages)?classPageC:classPageB">
                  <a class="page-link" @click="changePage(1)" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                    <span class="sr-only">Next</span>
                  </a>
                </li>
              </ul>
            </nav> -->
           

            <!-- 运费税收，折扣 -->
            <div class="row tax-coupon-div">




              <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="cart-total">
                  <ul>
                    <li>总价<span>${{money}}</span></li>
                    <li class="cart-black">合计<span>${{money}}</span></li>
                  </ul>
                  <div class="cart-total-btn">
                    <div class="cart-total-btn2 f-right" v-if="isChange" @click="changeQuantity()"><a>保存购物车</a>
                    </div>
                    <div class="cart-total-btn1 f-right" v-else>
                      <a href="checkout.html">结帐</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- shopping-cart-area end -->

        <!-- 订阅区域开始 -->
        <div class="subscribe-area gray-bg">
          <div class="container">
            <div class="subscribe-bg ptb-80">
              <div class="row">
                <div class="col-md-offset-3 col-md-6 col-sm-offset-2 col-sm-8 col-xs-offset-1 col-xs-10">
                  <div class="subscribe-from
                                                text-center">
                    <h3>订阅我们的通讯</h3>
                    <form action="#">
                      <input placeholder="输入邮箱" type="email" />
                      <button type="submit">订阅</button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- 订阅区域结束 -->

        <!-- 页脚开始 -->
        <footer class="footer-area">
          <div class="container">
            <div class="footer-top pt-60 pb-30">
              <div class="row">
                <div class="col-md-3 col-sm-4">
                  <div class="footer-widget mb-30">
                    <div class="footer-logo">
                      <a href="index.html">
                        <img src="assets/img/logo/logo-black.png" alt="" />
                      </a>
                    </div>
                    <div class="widget-info">
                      <p>
                        <i class="pe-7s-map-marker"> </i>
                        <span>
                          #湖南省长沙市天心区.
                          <br />
                          <span class="location">newer科技公司</span>
                        </span>
                      </p>
                      <p>
                        <i class="pe-7s-mail"></i>
                        <span>
                          <a href="mailto:contact@company.com">hloong.x@qq.com</a>
                        </span>
                      </p>
                      <p>
                        <i class="pe-7s-call"></i>
                        <span>+185 7439 5770 </span>
                      </p>
                    </div>
                    <div class="footer-social">
                      <ul>
                        <li>
                          <a href="#"><i class="fa fa-facebook"></i></a>
                        </li>
                        <li>
                          <a href="#"><i class="fa fa-twitter"></i></a>
                        </li>
                        <li>
                          <a href="#"><i class="fa fa-google-plus"></i></a>
                        </li>
                        <li>
                          <a href="#"><i class="fa fa-instagram"></i></a>
                        </li>
                        <li>
                          <a href="#"><i class="fa fa-pinterest-p"></i></a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-md-2 hidden-sm">
                  <div class="footer-widget mb-30">
                    <div class="footer-title">
                      <h3>类别</h3>
                    </div>
                    <div class="widget-text">
                      <ul>
                        <li><a href="#"> 服装</a></li>
                        <li><a href="#">鞋子 </a></li>
                        <li><a href="#">包包 </a></li>
                        <li><a href="#">手表 </a></li>
                        <li><a href="#">珠宝 </a></li>
                        <li><a href="#"> 军火</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-md-2 col-sm-2">
                  <div class="footer-widget mb-30">
                    <div class="footer-title">
                      <h3>服务</h3>
                    </div>
                    <div class="widget-text">
                      <ul>
                        <li><a href="#">关于我们 </a></li>
                        <li><a href="#">退货 </a></li>
                        <li><a href="#">发货 </a></li>
                        <li><a href="#">物流 </a></li>
                        <li><a href="#">联系客服 </a></li>
                        <li><a href="#">投诉 </a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-md-2 col-sm-3">
                  <div class="footer-widget mb-30">
                    <div class="footer-title">
                      <h3>快速链接</h3>
                    </div>
                    <div class="widget-text">
                      <ul>
                        <li><a href="#">登录 </a></li>
                        <li><a href="#">注册 </a></li>
                        <li><a href="#">订单 </a></li>
                        <li><a href="#">购物车</a></li>
                        <li><a href="#">结账 </a></li>
                        <li><a href="#">登记 </a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-md-3 col-sm-3">
                  <div class="footer-widget mb-30">
                    <div class="footer-title">
                      <h3>相关</h3>
                    </div>
                    <div class="widget-text">
                      <ul>
                        <li><a href="#">退货政策 </a></li>
                        <li><a href="#">隐私政策 </a></li>
                        <li><a href="#">产品保修 </a></li>
                        <li><a href="#">论坛</a></li>
                        <li><a href="#">订单跟踪 </a></li>
                        <li><a href="#">我套你猴子 </a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="footer-bottom ptb-20">
              <div class="row">
                <div class="col-md-6 col-sm-6">
                  <div class="copyright">
                    <p>
                      版权 © 2019
                      <a href="http://www.17sucai.com/">长沙newer</a>
                      . 最强项目小组.
                    </p>
                  </div>
                </div>
                <div class="col-md-6 col-sm-6">
                  <div class="payment f-right">
                    <ul>
                      <li>
                        <a href="#"><i class="fa fa-cc-paypal"></i></a>
                      </li>
                      <li>
                        <a href="#"><i class="fa fa-cc-visa"></i></a>
                      </li>
                      <li>
                        <a href="#"><i class="fa fa-cc-mastercard"></i></a>
                      </li>
                      <li>
                        <a href="#"><i class="fa fa-cc-discover"></i></a>
                      </li>
                      <li>
                        <a href="#"><i class="fa fa-cc-amex"></i></a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </footer>
        <!-- 页脚结束 -->
      </div>
      <!-- content end -->
    </div>
    <!-- content-wrap end -->
  </div>

  <!-- vue -->
  <script>
    new Vue({
      el: "#cart",
      data: {
        spec:'',
        url: 'http://192.168.43.98:8080',
        customer: {
          id: "",
          name: "",
          token: "",
          
        },
        categoryList:["电子","家具","衣物"],
        cartItem: {
          commodity: {
            id: 1,
            title: '',
            description: '',
            price:'',
            shelf:'',
            reconmmed:'',
            stock:'',
            category: '',
            brand: '',
            // specList:[] //商品规格列表
          },
          spec: {
            id: '',
            param: '',
            img: ''
          },
          quantity:'',
        },
        cart: [],
        money: 0,
        isChange: false,
        pages: 8,
        pagenum: 2,
        classPageA: 'page-item active',
        classPageB: 'page-item',
        classPageC: 'page-item disabled',
      },
      methods: {
        // 初始化,获取购物车列表
        init: function () {
          this.customer = JSON.parse(sessionStorage.getItem("customer"));
          axios.get(`${this.url}/api/v1/cart/check/${this.pagenum}`, 
          { 
            params:{
              uid:this.customer.id
            },
            headers: { 
              "content-Type":"application/json",
              'Authorization':`Bearer${this.customer.token}` } 
            })
          .then(Response => { 
            this.cart = Response.data.list; 
           
            
            console.log(Response.data.list); 
            console.log(123);
            console.log(this.cart); 
            console.log(this.cart[0].commodity.price)
            for (var n = 0; n < this.cart.length; n++) {
            this.money = this.money + (this.cart[n].commodity.price*this.cart[n].quantity);
          }
            
            });
         
         
          console.log('数据获取成功');
          

          
        },
        // 选择页码
        selectPage: function (i) {
          this.pagenum = i + 1;
          // axios.get('').then(Response=>{
          //     this.commodityList=Response.data;
          // });
        },
        // 加减页码
        changePage: function (n) {
          this.pagenum += n;
          if (this.pagenum <= 0) {
            this.pagenum = 1;
          };
          if (this.pagenum >= this.pages) {
            this.pagenum = this.pages;
          };
          console.log(this.pagenum);
        },
        // 删除订单项
        del: function (index) {
          console.log('删除商品');
          console.log(index)
          const param = new URLSearchParams();
          param.append("sid", this.cart[index].spec.id);
          param.append("cid", this.cart[index].commodity.id);
          param.append("uid", this.customer.id);
          console.log(this.cart[index].spec.id,this.cart[index].commodity.id,this.customer.id)
          axios.post(`${this.url}/api/v1/cart/dlt`, param,
          {
            headers:{
              'Authorization':`Bearer${this.customer.token}`
            }
          }).then((Response) => {
            this.init();
           });
        },

        // 是否修改
        change: function () {
          this.isChange = true;
          this.money=0;
        },

        // 修改购物车数量
        changeQuantity: function () {
          for (var n = 0; n < this.cart.length; n++) {
            console.log(this.cart[n].quantity);
            
            this.money = this.money + (this.cart[n].quantity * this.cart[n].commodity.price);
            console.log(1111)
            // const param = new URLSearchParams();
            // param.append("sid", this.cart[n].spec.id);
            // param.append("cid", this.cart[n].commodity.id);
            // param.append("quantity", this.cart[n].quantity);
            // axios.post(`${this.url}` / api / v1 / cart / change, param).then(Response => { });
           
          };
          console.log(1111)
          this.isChange = false;
        }
      },

      //结账,跳转到订单页面
      // checkout:function(){
      //   axios.get('').then(Response=>{});
      // },

      mounted() {
        this.init();
        
      },
    })
  </script>

  <!-- all js here -->
  <script src="assets/js/vendor/jquery-1.12.0.min.js"></script>
  <script src="assets/js/snap.svg-min.js"></script>
  <script src="assets/js/bootstrap.min.js"></script>
  <script src="assets/js/jquery.meanmenu.js"></script>
  <script src="assets/js/jquery.magnific-popup.min.js"></script>
  <script src="assets/js/isotope.pkgd.min.js"></script>
  <script src="assets/js/imagesloaded.pkgd.min.js"></script>
  <script src="assets/js/jquery.validate.min.js"></script>
  <script src="assets/js/owl.carousel.min.js"></script>
  <script src="lib/js/jquery.nivo.slider.js"></script>
  <script src="lib/home.js"></script>
  <script src="assets/js/plugins.js"></script>
  <script src="assets/js/main.js"></script>
  <script src="assets/js/classie.js"></script>
  <script src="assets/js/main3.js"></script>
</body>

</html>